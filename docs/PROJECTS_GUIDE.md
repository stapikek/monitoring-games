# Руководство по системе проектов

## Описание системы

Система проектов позволяет пользователям создавать страницы своих игровых проектов, объединяющих несколько серверов.

## Требования к проектам

1. **Минимум 2 активных сервера** - у владельца проекта должно быть не менее двух верифицированных серверов
2. **Оплата 100 рублей** - единоразовая оплата за размещение проекта навсегда
3. **Обязательные поля**:
   - Название проекта
   - Логотип проекта (соотношение сторон 16:9, 4:3 или 16:10)
   - Выбор минимум 2 серверов
   - Описание (минимум 50 символов)
4. **Необязательные поля**:
   - Веб-сайт
   - Discord Invite Code
   - ВКонтакте

## Функционал

### Для пользователей:

1. **Просмотр проектов** (`/projects.php`)
   - Список всех активных проектов
   - Фильтрация и сортировка

2. **Создание проекта** (`/add_project.php`)
   - Форма создания с валидацией
   - Загрузка логотипа
   - Выбор серверов из списка пользователя
   - BB-коды в описании: [b], [i], [u], [url]
   - Списание 100 рублей с баланса

3. **Страница проекта** (`/project.php?id=X`)
   - Детальная информация о проекте
   - Список всех серверов проекта
   - Ссылки на социальные сети
   - Общий рейтинг проекта

4. **Блок "Случайный проект"** (на главной странице)
   - Показывает случайный проект с рейтингом >= 100000
   - Липкий виджет справа от списка серверов
   - Автоматический выбор при каждой загрузке страницы

### Для администраторов:

1. **Управление проектами** (`/admin/projects.php`)
   - Просмотр всех проектов
   - Фильтрация по статусу (все/на модерации/активные/отклоненные)
   - Одобрение/отклонение проектов
   - Удаление проектов

## Структура базы данных

### Таблица `projects`
```sql
- id (INT, AUTO_INCREMENT, PRIMARY KEY)
- user_id (INT, FK -> users.id)
- name (VARCHAR 255) - название проекта
- description (TEXT) - описание с BB-кодами
- logo (VARCHAR 255) - путь к логотипу
- website (VARCHAR 255) - веб-сайт
- discord (VARCHAR 100) - код приглашения Discord
- vk (VARCHAR 255) - ссылка на VK
- total_rating (INT) - суммарный рейтинг всех серверов
- status (ENUM: pending/active/rejected)
- created_at (TIMESTAMP)
```

### Таблица `project_servers`
```sql
- id (INT, AUTO_INCREMENT, PRIMARY KEY)
- project_id (INT, FK -> projects.id)
- server_id (INT, FK -> servers.id)
```

## Расчет рейтинга проекта

Общий рейтинг проекта (`total_rating`) = сумма рейтингов всех серверов, связанных с проектом.

Обновляется автоматически при просмотре страницы проекта.

## Блок "Случайный проект"

- Отображается на главной странице справа от списка серверов
- Показывается только проекты с `total_rating >= 100000`
- Выбирается случайно при каждой загрузке страницы (`ORDER BY RAND()`)
- Включает:
  - Логотип проекта
  - Название
  - Статистику (рейтинг, количество серверов)
  - Краткое описание (первые 100 символов)
  - Кнопку "Подробнее"

## Файловая структура

```
/projects.php                  - список проектов
/add_project.php              - форма добавления проекта
/project.php                  - страница проекта
/admin/projects.php           - админ-панель управления
/uploads/projects/            - папка для логотипов
/sql/create_projects.sql      - SQL для создания таблиц
```

## BB-коды в описании

Поддерживаемые BB-коды:
- `[b]текст[/b]` - жирный текст
- `[i]текст[/i]` - курсив
- `[u]текст[/u]` - подчеркнутый текст
- `[url=ссылка]текст[/url]` - ссылка

## Валидация

1. **Логотип**:
   - Форматы: JPG, PNG, WEBP
   - Соотношение сторон: 16:9, 4:3, 16:10
   - Рекомендуемый размер: 1280x720px

2. **Описание**:
   - Минимум 50 символов
   - Поддержка BB-кодов

3. **Серверы**:
   - Минимум 2 сервера
   - Только активные серверы пользователя

4. **Баланс**:
   - Минимум 100 рублей на счету

## Примечания

- Проекты размещаются навсегда после единоразовой оплаты
- Статус проекта по умолчанию: `active` (можно изменить на `pending` для модерации)
- Удаление проекта автоматически удаляет связи с серверами (CASCADE)
- Общий рейтинг пересчитывается при каждом просмотре страницы проекта

